<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Okul Güreş Müsabakası</title>
  <link rel="icon" href="data:,">
  <style>
    body{margin:0;font-family:Arial,Helvetica,sans-serif;background:#111;color:#fff}
    header{display:flex;gap:10px;padding:15px;background:#1c1c1c}
    button{padding:10px 16px;border:none;cursor:pointer;background:#f5c400;font-weight:bold}
    .container{padding:20px}
    .match,.score-item{display:flex;align-items:center;gap:20px;background:#222;padding:15px;margin-bottom:15px;border-radius:8px}
    .fighter{display:flex;align-items:center;gap:10px;flex:1}
    .fighter img,.score-item img{width:80px;height:80px;object-fit:cover;border-radius:8px}
    .vs{font-size:22px;font-weight:bold;color:#f5c400}
    .score-name{flex:1;font-weight:bold}
    .score-point{font-size:18px;color:#f5c400}
    input{margin:5px 0;padding:8px;width:100%}
  </style>
</head>
<body>

<header>
  <button onclick="showPage('musabaka')">MÜSABAKALAR</button>
  <button onclick="showPage('puan')">PUAN LİSTESİ</button>
  <button onclick="showPage('admin')">ADMİN</button>
</header>

<div id="musabaka" class="container"></div>
<div id="puan" class="container" style="display:none"></div>

<div id="admin" class="container" style="display:none">
  <div id="loginBox">
    <h3>Admin Girişi</h3>
    <input type="password" id="pass" placeholder="Şifre">
    <button onclick="login()">Giriş</button>
  </div>

  <div id="panel" style="display:none">
    <h3>Müsabaka Ekle</h3>
    <input id="n1" placeholder="Sporcu 1">
    <input id="i1" type="file">
    <input id="n2" placeholder="Sporcu 2">
    <input id="i2" type="file">
    <button onclick="addMatch()">Ekle</button>

    <h3>Puan Ekle</h3>
    <input id="pn" placeholder="İsim">
    <input id="pi" type="file">
    <input id="ps" placeholder="Puan (0-1)">
    <button onclick="addScore()">Kaydet</button>
  </div>
</div>

<!-- FIREBASE -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getFirestore, collection, addDoc, onSnapshot, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

  const firebaseConfig = {
  apiKey: "AIzaSyAf116Bb_Rv-rXI8C47EeaIlwxJQbPk7ic",
  authDomain: "szbalfightclub-3a1ae.firebaseapp.com",
  projectId: "szbalfightclub-3a1ae",
  storageBucket: "szbalfightclub-3a1ae.firebasestorage.app",
  messagingSenderId: "303031679666",
  appId: "1:303031679666:web:142d4e8b5c4201353a67ab"
};

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const musDiv = document.getElementById('musabaka');
  const puanDiv = document.getElementById('puan');
  const admin = document.getElementById('admin');
  const loginBox = document.getElementById('loginBox');
  const panel = document.getElementById('panel');

  window.showPage = function(p){
    musDiv.style.display = p==='musabaka'?'block':'none';
    puanDiv.style.display = p==='puan'?'block':'none';
    admin.style.display = p==='admin'?'block':'none';
  }

  window.login = function(){
    if(document.getElementById('pass').value === 'ben1sma1ly1ld1r1m'){
      loginBox.style.display='none';
      panel.style.display='block';
    } else alert('Şifre yanlış');
  }

  function fileToBase64(file){
    return new Promise(res=>{const r=new FileReader();r.onload=()=>res(r.result);r.readAsDataURL(file)})
  }

  window.addMatch = async function(){
    const img1 = await fileToBase64(i1.files[0]);
    const img2 = await fileToBase64(i2.files[0]);
    await addDoc(collection(db,'matches'),{n1:n1.value,img1,n2:n2.value,img2});
  }

  window.addScore = async function(){
    const img = await fileToBase64(pi.files[0]);
    await addDoc(collection(db,'scores'),{name:pn.value,img,score:ps.value});
  }

  onSnapshot(collection(db,'matches'),snap=>{
    musDiv.innerHTML='';
    snap.forEach(d=>{
      const m=d.data();
      musDiv.innerHTML+=`<div class="match"><div class="fighter"><img src="${m.img1}"><span>${m.n1}</span></div><div class="vs">VS</div><div class="fighter"><img src="${m.img2}"><span>${m.n2}</span></div></div>`
    })
  })

  onSnapshot(collection(db,'scores'),snap=>{
    puanDiv.innerHTML='';
    snap.forEach(d=>{
      const s=d.data();
      puanDiv.innerHTML+=`<div class="score-item"><img src="${s.img}"><div class="score-name">${s.name}</div><div class="score-point">${s.score}</div></div>`
    })
  })
</script>

</body>
</html>
