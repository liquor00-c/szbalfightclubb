<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Okul GÃ¼reÅŸ MÃ¼sabakasÄ±</title>
  <style>
    body{margin:0;font-family:Arial,Helvetica,sans-serif;background:#111;color:#fff;transition:.3s}
    body.light{background:#f4f4f4;color:#111}
    header{display:flex;gap:10px;padding:15px;background:#1c1c1c}
    body.light header{background:#ddd}
    button{padding:10px 16px;border:none;cursor:pointer;background:#f5c400;font-weight:bold;border-radius:6px}
    .container{padding:20px;max-width:1100px;margin:auto}

    /* MÃœSABAKA */
    .match{display:flex;align-items:center;gap:20px;background:#222;padding:15px;margin-bottom:15px;border-radius:10px}
    body.light .match{background:#fff}
    .fighter{display:flex;align-items:center;gap:10px;flex:1}
    .fighter img{width:80px;height:80px;object-fit:cover;border-radius:8px}
    .vs{font-size:22px;font-weight:bold;color:#f5c400}

    /* PUAN */
    .score-item{display:flex;align-items:center;gap:15px;background:#222;padding:12px;margin-bottom:12px;border-radius:10px}
    body.light .score-item{background:#fff}
    .score-item img{width:70px;height:70px;object-fit:cover;border-radius:8px}
    .score-name{flex:1;font-weight:bold}
    .score-point{font-size:18px;color:#f5c400}

    input{margin:6px 0;padding:8px;width:100%}
    .danger{background:#c62828;color:#fff}
  </style>
</head>
<body>

<header>
  <button onclick="showPage('musabaka')">MÃœSABAKALAR</button>
  <button onclick="showPage('puan')">PUAN LÄ°STESÄ°</button>
  <button onclick="showPage('admin')">ADMÄ°N</button>
  <button onclick="toggleTheme()">Koyu / AÃ§Ä±k</button>
</header>

<div id="musabaka" class="container"></div>
<div id="puan" class="container" style="display:none"></div>

<div id="admin" class="container" style="display:none">
  <div id="loginBox">
    <h3>Admin GiriÅŸi</h3>
    <input type="password" id="pass" placeholder="Åžifre">
    <button onclick="login()">GiriÅŸ</button>
  </div>

  <div id="panel" style="display:none">
    <h3>MÃ¼sabaka Ekle</h3>
    <input id="n1" placeholder="Sporcu 1">
    <input id="i1" type="file">
    <input id="n2" placeholder="Sporcu 2">
    <input id="i2" type="file">
    <button onclick="addMatch()">Ekle</button>

    <h3>Puan Ekle / GÃ¼ncelle</h3>
    <input id="pn" placeholder="Ä°sim">
    <input id="pi" type="file">
    <input id="ps" placeholder="Puan (Ã¶rn: 0-1)">
    <button onclick="addScore()">Kaydet</button>
  </div>
</div>

<script type="module">
// ðŸ”¥ FIREBASE BAÄžLANTISI
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

// âš ï¸ BURAYI FIREBASE'DEN ALIP YAPIÅžTIRACAKSIN
const firebaseConfig = {
  apiKey: "AIzaSyAf116Bb_Rv-rXI8C47EeaIlwxJQbPk7ic",
  authDomain: "szbalfightclub-3a1ae.firebaseapp.com",
  projectId: "szbalfightclub-3a1ae",
  storageBucket: "szbalfightclub-3a1ae.firebasestorage.app",
  messagingSenderId: "303031679666",
  appId: "1:303031679666:web:142d4e8b5c4201353a67ab"
};



const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const musDiv = document.getElementById('musabaka');
const puanDiv = document.getElementById('puan');
const adminDiv = document.getElementById('admin');
let isAdmin = false;

function showPage(p){
  musDiv.style.display = p==='musabaka'?'block':'none';
  puanDiv.style.display = p==='puan'?'block':'none';
  adminDiv.style.display = p==='admin'?'block':'none';
}

function toggleTheme(){document.body.classList.toggle('light')}

function login(){
  if(pass.value==='ben1sma1ly1ld1r1m'){
    isAdmin=true;loginBox.style.display='none';panel.style.display='block';
  } else alert('Åžifre yanlÄ±ÅŸ');
}

// ðŸ“¥ MÃœSABAKALARI Ã‡EK
async function loadMatches(){
  musDiv.innerHTML='';
  const snap = await getDocs(collection(db,"matches"));
  snap.forEach(d=>{
    const m=d.data();
    musDiv.innerHTML+=`
    <div class="match">
      <div class="fighter"><img src="${m.i1}"><span>${m.n1}</span></div>
      <div class="vs">VS</div>
      <div class="fighter"><img src="${m.i2}"><span>${m.n2}</span></div>
      ${isAdmin?`<button onclick="deleteMatch('${d.id}')">Sil</button>`:''}
    </div>`;
  });
}

// âž• MÃœSABAKA EKLE
async function addMatch(){
  const r1=new FileReader(),r2=new FileReader();
  r1.onload=()=>{r2.onload=async()=>{
    await addDoc(collection(db,"matches"),{
      n1:n1.value,n2:n2.value,i1:r1.result,i2:r2.result
    });
    loadMatches();
  };r2.readAsDataURL(i2.files[0]);};
  r1.readAsDataURL(i1.files[0]);
}

async function deleteMatch(id){
  if(isAdmin){await deleteDoc(doc(db,"matches",id));loadMatches();}
}

// ðŸ† PUANLAR
async function loadScores(){
  puanDiv.innerHTML='';
  const snap = await getDocs(collection(db,"scores"));
  snap.forEach(d=>{
    const s=d.data();
    puanDiv.innerHTML+=`
    <div class="score-item">
      <img src="${s.img}">
      <div class="score-name">${s.name}</div>
      <div class="score-point">${s.score}</div>
      ${isAdmin?`<button onclick="editScore('${d.id}')">DeÄŸiÅŸtir</button>
      <button onclick="deleteScore('${d.id}')">Sil</button>`:''}
    </div>`;
  });
}

async function addScore(){
  const r=new FileReader();
  r.onload=async()=>{
    await addDoc(collection(db,"scores"),{
      name:pn.value,score:ps.value,img:r.result
    });
    loadScores();
  };
  r.readAsDataURL(pi.files[0]);
}

async function editScore(id){
  const v=prompt('Yeni puan');
  if(v) await updateDoc(doc(db,"scores",id),{score:v});
  loadScores();
}

async function deleteScore(id){
  if(isAdmin){await deleteDoc(doc(db,"scores",id));loadScores();}
}

loadMatches();
loadScores();
</script>

</body>
</html>
